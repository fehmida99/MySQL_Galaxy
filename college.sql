CREATE DATABASE college1;
USE college1;

CREATE TABLE student(
rollno INT PRIMARY KEY,
name VARCHAR(50),
marks INT NOT NULL,
grade VARCHAR(20),
city VARCHAR(20)
);

DESCRIBE student;
DROP TABLE STUDENT;

SELECT * FROM STUDENT;

INSERT INTO student 
(rollno, name, marks,grade,city)
VALUES
(101, "anil",78,"C", "Pune"),
(102, "bhumika",93,"A", "Mumbai"),
(103, "chetan",85,"B", "Mumbai"),
(104, "dhruv",96,"A", "Delhi"),
(105, "emanuel",12,"F", "Delhi"),
(106, "farah",82,"B", "Delhi");

SELECT * FROM student;


-- NOW USING ALTER COMMAND 

ALTER TABLE student 
ADD COLUMN age INT NOT NULL;

SELECT * FROM student;

ALTER TABLE student 
DROP COLUMN age ;


ALTER TABLE student 
ADD COLUMN age INT NOT NULL DEFAULT 19;

ALTER TABLE student
MODIFY COLUMN age Varchar(2);

Describe student;

ALTER TABLE student 
CHANGE age stu_age INT;

SELECT * FROM student;

ALTER TABLE student 
DROP COLUMN stu_age;

ALTER TABLE student 
RENAME to stu;

ALTER TABLE STU
RENAME TO STUDENT;

SELECT * FROM stu;

drop table student;
describe student;
describe stu;

SELECT name , marks FROM student;
SELECT * FROM student;
SELECT city FROM student;

SELECT DISTINCT city FROM student;
SELECT DISTINCT GRADE FROM STUDENT;

SELECT * FROM STUDENT WHERE MARKS > 80;
SELECT * FROM STUDENT WHERE CITY = "mumbai";

SELECT *
FROM student
WHERE marks+10 > 100;


SELECT *
FROM student
WHERE marks =  12;


SELECT *
FROM student
WHERE marks >  80 OR city = "Gujrat";


SELECT *
FROM STUDENT
WHERE MARKS BETWEEN 80 AND 90;


SELECT * 
FROM STUDENT
WHERE MARKS = 12;


SELECT * 
FROM STUDENT
WHERE CITY IN ("MUMBAI","DELHI");


SELECT * 
FROM STUDENT
WHERE CITY Not IN ("MUMBAI","DELHI");


SELECT * 
FROM STUDENT 
WHERE MARKS>80
LIMIT 3;

SELECT *
FROM STUDENT
ORDER BY CITY ASC;


SELECT *
FROM STUDENT
ORDER BY CITY DESC;

SELECT *
FROM STUDENT
ORDER BY MARKS DESC
LIMIT 3;

SELECT MAX(MARKS)
FROM STUDENT;


SELECT MIN(MARKS)
FROM STUDENT;

SELECT COUNT(NAME)
FROM STUDENT;


SELECT COUNT(CITY)
FROM STUDENT
WHERE CITY LIKE 'M%' ;


SELECT CITY 
FROM STUDENT 
GROUP BY CITY;

SELECT CITY, COUNT(rollno)
FROM STUDENT
GROUP BY CITY;

SELECT CITY,NAME, COUNT(rollno)
FROM STUDENT
GROUP BY CITY,NAME;

SELECT CITY,NAME, AVG(MARKS)
FROM STUDENT
GROUP BY CITY,NAME;


-- SELECT CITY, AVG(MARKS) 
-- FROM STUDENT
-- GROUP BY CITY
-- ORDER BY CITY ASC;


SELECT CITY , AVG(MARKS)
FROM STUDENT
GROUP BY CITY;

SELECT CITY , AVG(MARKS)
FROM STUDENT
GROUP BY CITY
ORDER BY CITY ASC;

SELECT CITY , AVG(MARKS)
FROM STUDENT
GROUP BY CITY
ORDER BY AVG(MARKS) DESC;

-- (101, "anil",78,"C", "Pune"),
-- (102, "bhumika",93,"A", "Mumbai"),
-- (103, "chetan",85,"B", "Mumbai"),
-- (104, "dhruv",96,"A", "Delhi"),
-- (105, "emanuel",12,"F", "Delhi"),
-- (106, "farah",82,"B", "Delhi");


SELECT GRADE, COUNT(ROLLNO)
FROM STUDENT
GROUP BY GRADE
ORDER BY GRADE;

SELECT CITY, COUNT(NAME)
FROM STUDENT 
GROUP BY CITY
HAVING MAX(MARKS)>90;


SELECT CITY 
FROM STUDENT
WHERE GRADE = "A"
GROUP BY CITY
HAVING MAX(MARKS)>=93
ORDER BY CITY ASC;


SELECT CITY 
FROM STUDENT
WHERE GRADE = "A"
GROUP BY CITY
HAVING MAX(MARKS)>=93
ORDER BY CITY DESC;

-- DML QUERY
-- FOR TURN OFF UPDATE MODE SO WE CAN DO CHANGES IN SQL
SET SQL_SAFE_UPDATES = 0;

UPDATE STUDENT
SET GRADE = "O"
WHERE GRADE = "A";

SELECT * FROM STUDENT;

UPDATE STUDENT 
SET MARKS = 84
WHERE ROLLNO = 105;


UPDATE STUDENT 
SET GRADE = "B"
WHERE MARKS BETWEEN 80 AND 90 ;

SELECT * FROM STUDENT;


UPDATE STUDENT
SET MARKS = MARKS+1;


UPDATE STUDENT 
SET MARKS = 12
WHERE ROLLNO = 105;

DELETE FROM STUDENT 
WHERE MARKS<30;


SELECT * FROM STUDENT;



-- NOW WE HAVE TO USE FOREIGH KEY :

-- parent table - teacher
CREATE TABLE teacher(
id INT PRIMARY KEY,
name VARCHAR(50),
dept_id INT,
FOREIGN KEY (dept_id) REFERENCES dept(id)
ON UPDATE CASCADE
ON DELETE CASCADE
);


insert into teacher 
VALUES
(101,"Adam",101),
(102,"Eve",102);

SELECT * FROM TEACHER;

CREATE TABLE dept(
id INT PRIMARY KEY,
name VARCHAR(50)
);

INSERT INTO dept
(id,name)
values
(101 , "english"),
(102,"IT");
 

select * from dept;

UPDATE dept
SET id = 111
where id = 101;


UPDATE dept
SET id = 103
where id = 102;


UPDATE teacher 
SET name = "Livious"
where name = "Eve";


ALTER TABLE STUDENT
CHANGE COLUMN NAME FULL_NAME VARCHAR(20) NOT NULL;

SELECT * FROM STUDENT;

ALTER TABLE STUDENT
DROP COLUMN GRADE;


DELETE FROM STUDENT WHERE MARKS < 80;


SELECT AVG(MARKS)
FROM STUDENT;


SELECT NAME , MARKS
FROM STUDENT
WHERE MARKS > 74.3333;

-- SUBQUERY
SELECT NAME , MARKS
FROM STUDENT
WHERE MARKS>(SELECT AVG(MARKS)
FROM STUDENT);


SELECT *
FROM STUDENT
WHERE ROLLNO % 2=0;

SELECT  ROLLNO
FROM STUDENT
WHERE ROLLNO%2=0;

SELECT NAME, ROLLNO
FROM STUDENT 
WHERE ROLLNO IN (102,104,106);



SELECT NAME, ROLLNO
FROM STUDENT 
WHERE ROLLNO IN (SELECT  ROLLNO
FROM STUDENT
WHERE ROLLNO%2=0);


SELECT * FROM STUDENT;




SELECT * 
FROM STUDENT
WHERE CITY = "DELHI";


SELECT MAX(MARKS)
FROM (SELECT * FROM STUDENT WHERE CITY = "MUMBAI") AS TEMP;



SELECT MAX(MARKS) 
FROM STUDENT
WHERE CITY = "MUMBAI";


SELECT (SELECT MAX(MARKS)FROM STUDENT)AS AVG_COL, NAME
FROM STUDENT;


-- FOR CREATING VIRTUAL TABLE

CREATE VIEW VIEW1 AS
SELECT ROLLNO, NAME, MARKS FROM STUDENT;

SELECT * FROM VIEW1;

SELECT * FROM VIEW1 
WHERE MARKS > 90;

DROP VIEW V1;






